package com.sinontech.dao.impl;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

import com.sinontech.dao.BaseDao;
import com.sinontech.modle.ArticleChapter;
import com.sinontech.modle.ArticleChapterLog;

@Repository("articleChapterdao")
public class ArticleChapterDaoImpl {

	@Autowired
	BaseDao baseDao;

	public void setBaseBo(BaseDao baseDao) {
		this.baseDao = baseDao;
	}
	
	public void updateArticleChapter(ArticleChapter articleChapter){
		this.baseDao.update(articleChapter);
	}
 
	/**
	 * 	用途说明：查询书籍的章节
	 * @param articleid
	 * @return
	 * 2018年2月27日下午1:59:45
	 * @auther ljj
	 */
	public List<ArticleChapter> getArticleChapterByarticleId(long articleid ){
		String sql = "select a.* from TB_ARTICLE_CHAPTER a,TB_ARTICLE b where a.ARTICLE_ID =b.ARTICLE_ID and a.ARTICLE_ID =? and b.STATE=1 and a.CHAPTER_STATE = 0 order by a.CHAPTER_NO asc  ";
		List<ArticleChapter> list= this.baseDao.findObjListBySql(sql, ArticleChapter.class,articleid  );
		return list;
	}
	
	/**
	 * 用途说明：获取书籍的第一个章节
	 * @param articleid
	 * @return
	 * 2018年3月1日上午10:24:26
	 * @auther ljj
	 */
	public ArticleChapter getArticleChapterFirstByarticleId(long articleid ){
		String sql = "select a.* from TB_ARTICLE_CHAPTER a,TB_ARTICLE b where a.ARTICLE_ID =b.ARTICLE_ID and a.ARTICLE_ID =? and b.STATE=1 and a.CHAPTER_STATE = 0 order by a.CHAPTER_NO asc  ";
		List<ArticleChapter> list= this.baseDao.findObjListBySql(sql, ArticleChapter.class,articleid  );
		if(null!=list&& list.size()>0){
			return list.get(0);
		}else{
			return null;
		}
	}
	
	/**
	 * 
	 * 用途：查询书籍章节
	 * @param @param articlechapterid
	 * @param @return
	 * @return ArticleChapter
	 * @author liuzhen
	 * 时间 2018-3-2 下午2:42:46
	 */
	public ArticleChapter getArticleChapterById(long articlechapterid) {
		String sql = "select tac.* from TB_ARTICLE_CHAPTER tac LEFT JOIN tb_article ta ON tac.ARTICLE_ID = ta.ARTICLE_ID where ta.STATE = 1 AND tac.ARTICLE_CHAPTER_ID = ? and  tac.CHAPTER_STATE = 0 ";
		List<ArticleChapter> list= this.baseDao.findObjListBySql(sql, ArticleChapter.class,articlechapterid  );
		if(null!=list&& list.size()>0){
			return list.get(0);
		}else{
			return null;
		}
	} 
	
}
