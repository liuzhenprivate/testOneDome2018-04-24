package com.sinontech.dao.impl;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Repository;

import com.sinontech.dao.BaseDao;
import com.sinontech.modle.ArticleChapterLog;

@Repository("articleChapterLogdao")
public class ArticleChapterLogDaoImpl {

	@Autowired
	BaseDao baseDao;

	public void setBaseBo(BaseDao baseDao) {
		this.baseDao = baseDao;
	}
	
	public void saveArticleChapterLog(ArticleChapterLog articleChapterLog){
		this.baseDao.save(articleChapterLog);
	}
 
	/**
	 * 	用途说明：查询用户的章节阅读记录
	 * @param userid
	 * @return
	 * 2018年2月27日下午1:59:45
	 * @auther ljj
	 */
	public List<ArticleChapterLog> getArticleChapterLogByUserId(long userid ){
		String sql = "select * from TB_ARTICLE_CHAPTERLOG a,TB_ARTICLE b,TB_ARTICLE_CHAPTER c where a.ARTICLE_ID=b.ARTICLE_ID and a.ARTICLE_CHAPTER_ID=c.ARTICLE_CHAPTER_ID and a.USERID=? order by a.ARTICLE_CHAPTERLOG_ID desc  ";
		List<ArticleChapterLog> list= this.baseDao.findObjListBySql(sql, ArticleChapterLog.class,userid  );
		return list;
	}
	
	/**
	 * 用途说明：查询用户具体书籍下的章节记录
	 * @param userid
	 * @param articleid
	 * @return
	 * 2018年2月27日下午1:59:59
	 * @auther ljj
	 */
	public List<ArticleChapterLog> getArticleChapterLogByUserIdAndArticleid(long userid,long articleid ){
		String sql = "select * from TB_ARTICLE_CHAPTERLOG a  where   a.USERID=? and a.ARTICLE_ID=? order by a.ARTICLE_CHAPTERLOG_ID desc  ";
		List<ArticleChapterLog> list= this.baseDao.findObjListBySql(sql, ArticleChapterLog.class,userid,articleid  );
		return list;
	}
	/**
	 * 用途说明：查询用户阅读书籍的最新章节
	 * @param userid
	 * @param articleid
	 * @return
	 * 2018年3月1日上午9:34:00
	 * @auther ljj
	 */
	public ArticleChapterLog getNewArticleChapterLogByUserIdAndArticleid(long userid,long articleid ){
		String sql = "select * from TB_ARTICLE_CHAPTERLOG a, TB_ARTICLE_CHAPTER c where   a.ARTICLE_CHAPTER_ID=c.ARTICLE_CHAPTER_ID and a.USERID=? and a.ARTICLE_ID=? order by c.CHAPTER_NO desc  ";
		List<ArticleChapterLog> list= this.baseDao.findObjListBySql(sql, ArticleChapterLog.class,userid,articleid  );
		if(null!=list && list.size()>0){
			return list.get(0);
		}else{
			return null;
		}
	}
	
}
