<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ArticleMapper">
	
	
	<!-- 新增-->
	<insert id="save" parameterType="pd">
		insert into TB_ARTICLE(
			ARTICLE_CATEGORY_ID,	
			ARTICLE_CODE,	
			ARTICLE_NAME,	
			AUTHOR,	
			FEE_TYPE,	
			IS_HOT,	
			SUMMARY,	
			COUNT_LETTER,	
			COUNT_CHAPTERS,	
			STATE,	
			CREATE_TIME,	
			READERS,	
			COUNT_CONSUMES,	
			CHANNEL_TYPE,
			SERIAL_STATE,
			BOOK_COVER
		) values (
			#{ARTICLE_CATEGORY_ID},	
			#{ARTICLE_CODE},	
			#{ARTICLE_NAME},	
			#{AUTHOR},	
			#{FEE_TYPE},	
			#{IS_HOT},	
			#{SUMMARY},	
			#{COUNT_LETTER},	
			#{COUNT_CHAPTERS},	
			#{STATE},	
			#{CREATE_TIME},	
			#{READERS},	
			#{COUNT_CONSUMES},	
			#{CHANNEL_TYPE},
			#{SERIAL_STATE},
			#{BOOK_COVER}
		)
	</insert>
	
	
	<!-- 删除-->
	<delete id="delete" parameterType="pd">
		delete from TB_ARTICLE
		where 
			ARTICLE_ID = #{ARTICLE_ID}
	</delete>
	
	
	<!-- 修改 -->
	<update id="edit" parameterType="pd">
		update  TB_ARTICLE
			set 
				<if test="ARTICLE_CATEGORY_ID!=null and ARTICLE_CATEGORY_ID!=''">
				ARTICLE_CATEGORY_ID = #{ARTICLE_CATEGORY_ID},
				</if>
				<if test="ARTICLE_CODE!=null and ARTICLE_CODE!=''">
				ARTICLE_CODE = #{ARTICLE_CODE},
				</if>
				<if test="ARTICLE_NAME!=null and ARTICLE_NAME!=''">
				ARTICLE_NAME = #{ARTICLE_NAME},
				</if>
				<if test="AUTHOR!=null and AUTHOR!=''">
				AUTHOR = #{AUTHOR},
				</if>
				<if test="FEE_TYPE!=null and FEE_TYPE!=''">
				FEE_TYPE = #{FEE_TYPE},
				</if>
				<if test="PAY_CONSUMES!=null and PAY_CONSUMES!=''">
				PAY_CONSUMES = #{PAY_CONSUMES},
				</if>
				<if test="IS_HOT!=null and IS_HOT!=''">
				IS_HOT = #{IS_HOT},
				</if>
				<if test="SUMMARY!=null and SUMMARY!=''">
				SUMMARY = #{SUMMARY},
				</if>
				<if test="COUNT_LETTER!=null and COUNT_LETTER!=''">
				COUNT_LETTER = #{COUNT_LETTER},
				</if>
				<if test="COUNT_CHAPTERS!=null and COUNT_CHAPTERS!=''">
				COUNT_CHAPTERS = #{COUNT_CHAPTERS},
				</if>
				<if test="STATE!=null and STATE!=''">
				STATE = #{STATE},
				</if>
				<if test="READERS!=null and READERS!=''">
				READERS = #{READERS},
				</if>
				<if test="COUNT_CONSUMES!=null and COUNT_CONSUMES!=''">
				COUNT_CONSUMES = #{COUNT_CONSUMES},
				</if>
				<if test="CHANNEL_TYPE!=null and CHANNEL_TYPE!=''">
				CHANNEL_TYPE = #{CHANNEL_TYPE},
				</if>
				<if test="SERIAL_STATE!=null and SERIAL_STATE!=''">
				SERIAL_STATE = #{SERIAL_STATE},
				</if>
				<if test="BOOK_COVER!=null and BOOK_COVER!=''">
				BOOK_COVER = #{BOOK_COVER},
				</if>
				<if test="RECOMMEND!=null and RECOMMEND!=''">
				RECOMMEND = #{RECOMMEND},
				</if>
				ARTICLE_ID =ARTICLE_ID
			where 
				ARTICLE_ID = #{ARTICLE_ID}
	</update>
	
	<!-- 修改书籍显示阅读人数 -->
	<update id="updateReads" parameterType="pd">
		update 
				TB_ARTICLE
		set 
				DISPLAY_READERS = #{DISPLAY_READERS}
				where
				ARTICLE_ID = #{ARTICLE_ID}
	</update>
	
	<!-- 通过ID获取数据 -->
	<select id="findById" parameterType="pd" resultType="pd">
		select 
			a.ARTICLE_ID,	
			a.ARTICLE_CATEGORY_ID,	
			a.ARTICLE_CODE,	
			a.ARTICLE_NAME,	
			a.AUTHOR,	
			a.FEE_TYPE,	
			a.PAY_CONSUMES,	
			a.IS_HOT,	
			a.SUMMARY,	
			a.COUNT_LETTER,	
			a.COUNT_CHAPTERS,	
			a.STATE,	
			a.CREATE_TIME,
			a.COLLECTION,	
			a.READERS,	
			a.COUNT_CONSUMES,	
			a.CHANNEL_TYPE,
			a.SERIAL_STATE,
			a.BOOK_COVER,
			a.RECOMMEND,
			ac.CATEGORY
		from 
			TB_ARTICLE a
			LEFT JOIN tb_article_category ac on a.ARTICLE_CATEGORY_ID = ac.ARTICLE_CATEGORY_ID
		where 
			a.ARTICLE_ID = #{ARTICLE_ID}
	</select>
	
	
	<!-- 列表 -->
	<select id="datalistPage" parameterType="page" resultType="pd">
		select
				a.ARTICLE_ID,	
				a.ARTICLE_CATEGORY_ID,	
				a.ARTICLE_CODE,	
				a.ARTICLE_NAME,	
				a.AUTHOR,	
				a.FEE_TYPE,	
				a.PAY_CONSUMES,	
				a.IS_HOT,	
				a.SUMMARY,	
				a.COUNT_LETTER,	
				a.COUNT_CHAPTERS,	
				a.STATE,	
				SUBSTRING(a.CREATE_TIME,1,10) CREATE_TIME,
				a.COLLECTION,	
				a.READERS,
				a.DISPLAY_READERS,	
				a.COUNT_CONSUMES,	
				a.CHANNEL_TYPE,
				a.SERIAL_STATE,
				a.BOOK_COVER,
				ac.CATEGORY,
				a.RECOMMEND
		from 
				TB_ARTICLE a
				LEFT JOIN tb_article_category ac on a.ARTICLE_CATEGORY_ID = ac.ARTICLE_CATEGORY_ID
		where a.STATE != -1
				<if test="pd.IS_HOT1 !=null and pd.IS_HOT1 !=''">
					and a.IS_HOT = #{pd.IS_HOT1}
				</if>
				<if test="pd.STATE1 !=null and pd.STATE1 !=''">
					and a.STATE = #{pd.STATE1}
				</if>
				<if test="pd.CHANNEL_TYPE1 !=null and pd.CHANNEL_TYPE1 !=''">
					and a.CHANNEL_TYPE = #{pd.CHANNEL_TYPE1}
				</if>
				<if test="pd.SERIAL_STATE1 !=null and pd.SERIAL_STATE1 !=''">
					and a.SERIAL_STATE = #{pd.SERIAL_STATE1}
				</if>
				<if test="pd.CATEGORY1 !=null and pd.CATEGORY1 !=''">
					and a.ARTICLE_CATEGORY_ID = (
						select ARTICLE_CATEGORY_ID from TB_ARTICLE_CATEGORY
						where CATEGORY = #{pd.CATEGORY1}
					)
				</if>
				<if test="pd.startTime!=null and pd.startTime!='' ">
					AND UPDATE_TIME >=#{pd.startTime}
				</if>
				<if test="pd.endTime!=null and pd.endTime!='' ">
					<![CDATA[   
						AND UPDATE_TIME <= #{pd.endTime}
					]]>   
				</if>
				<if test="pd.names!=null and pd.names!=''">
				AND	(
					a.ARTICLE_ID LIKE CONCAT(CONCAT('%', #{pd.names}),'%')
					or
					a.ARTICLE_NAME LIKE CONCAT(CONCAT('%', #{pd.names}),'%')
					or
					a.AUTHOR LIKE CONCAT(CONCAT('%', #{pd.names}),'%')
				)
				</if>
				ORDER BY a.CREATE_TIME desc
	</select>
	
	<!-- 列表(全部) -->
	<select id="listAll" parameterType="pd" resultType="pd">
		select
				a.ARTICLE_ID,	
				a.ARTICLE_CATEGORY_ID,	
				a.ARTICLE_CODE,	
				a.ARTICLE_NAME,	
				a.AUTHOR,	
				a.FEE_TYPE,	
				a.PAY_CONSUMES,	
				a.IS_HOT,	
				a.SUMMARY,	
				a.COUNT_LETTER,	
				a.COUNT_CHAPTERS,	
				a.STATE,	
				SUBSTRING(a.CREATE_TIME,1,10) CREATE_TIME,	
				a.READERS,
				a.DISPLAY_READERS,	
				a.COLLECTION,	
				a.COUNT_CONSUMES,	
				a.CHANNEL_TYPE,
				a.SERIAL_STATE,
				a.BOOK_COVER,
				a.RECOMMEND,
				ac.CATEGORY,
				ac.CATEGORY_TYPE
		from 
				TB_ARTICLE a
				LEFT JOIN tb_article_category ac on a.ARTICLE_CATEGORY_ID = ac.ARTICLE_CATEGORY_ID
		where 1=1
				<if test="PAY_WAY1 !=null and PAY_WAY1 !=''">
					and a.PAY_WAY = #{PAY_WAY1}
				</if>
				<if test="IS_HOT1 !=null and IS_HOT1 !=''">
					and a.IS_HOT = #{IS_HOT1}
				</if>
				<if test="STATE1 !=null and STATE1 !=''">
					and a.STATE = #{STATE1}
				</if>
				<if test="CHANNEL_TYPE1 !=null and CHANNEL_TYPE1 !=''">
					and a.CHANNEL_TYPE = #{CHANNEL_TYPE1}
				</if>
				<if test="SERIAL_STATE1 !=null and SERIAL_STATE1 !=''">
					and a.SERIAL_STATE = #{SERIAL_STATE1}
				</if>
				<if test="CATEGORY1 !=null and CATEGORY1 !=''">
					and a.ARTICLE_CATEGORY_ID = (
						select ARTICLE_CATEGORY_ID from TB_ARTICLE_CATEGORY
						where CATEGORY = #{CATEGORY1}
					)
				</if>
				<if test="SEARCHKEY !=null and SEARCHKEY !=''">
					and (a.ARTICLE_NAME like CONCAT(CONCAT('%', #{SEARCHKEY}),'%')
					     or a.AUTHOR like CONCAT(CONCAT('%', #{SEARCHKEY}),'%')
					     )
				</if>
	</select>
	
	<!-- 批量删除 -->
	<delete id="deleteAll" parameterType="String">
		delete from TB_ARTICLE
		where 
			ARTICLE_ID in
		<foreach item="item" index="index" collection="array" open="(" separator="," close=")">
                 #{item}
		</foreach>
	</delete>
	
	<!-- 下架/上架修改 -->
	<update id="editState" parameterType="pd">
		update  TB_ARTICLE
			set 
				STATE = #{STATE}
			where 
				ARTICLE_ID = #{ARTICLE_ID}
	</update>
	
	<!--  获取最后一条书籍数据-->
	<select id="findNext" parameterType="pd" resultType="pd">
		select 
			ARTICLE_ID,
			ARTICLE_CODE	
		from 
			TB_ARTICLE
			order by ARTICLE_ID desc
			limit 0,1
	</select>
	
	<!-- 添加书籍-->
	<insert id="addBook" parameterType="pd">
		insert into TB_ARTICLE(
			ARTICLE_NAME,
			ARTICLE_CATEGORY_ID,
			ARTICLE_CODE,	
			AUTHOR,	
			FEE_TYPE,	
			IS_HOT,	
			SUMMARY,	
			CREATE_TIME,	
			BOOK_COVER,
			RECOMMEND
		) values (
			#{ARTICLE_NAME},
			#{ARTICLE_CATEGORY_ID},	
			#{ARTICLE_CODE},
			#{AUTHOR},	
			#{FEE_TYPE},	
			#{IS_HOT},	
			#{SUMMARY},	
			#{CREATE_TIME},	
			#{BOOK_COVER},
			#{RECOMMEND}
		)
	</insert>
	
	
	<!-- 修改书籍 -->
	<update id="editfile" parameterType="pd">
		update  TB_ARTICLE
			set 
				ARTICLE_NAME = #{ARTICLE_NAME},
				AUTHOR = #{AUTHOR},
				FEE_TYPE = #{FEE_TYPE},
				<if test="BOOK_COVER !=null and BOOK_COVER !=''">
					BOOK_COVER = #{BOOK_COVER},
				</if>
				IS_HOT = #{IS_HOT},
				SUMMARY = #{SUMMARY},
				RECOMMEND = #{RECOMMEND},
				ARTICLE_CATEGORY_ID = #{ARTICLE_CATEGORY_ID}
			where 
				ARTICLE_ID = #{ARTICLE_ID}
	</update>
	
	<!-- 书籍下 架   -->
	<update id="bacthAllStatedown" parameterType="String">
		update  TB_ARTICLE
			set 
				STATE = 2
			where 
				ARTICLE_ID in
				<foreach item="item" index="index" collection="array" open="(" separator="," close=")">
		                 #{item}
				</foreach>
	</update>
	
	<!-- 书籍上架   -->
	<update id="bacthAllStateup" parameterType="String">
		update  TB_ARTICLE
			set 
				STATE = 1
			where 
				ARTICLE_ID in
				<foreach item="item" index="index" collection="array" open="(" separator="," close=")">
		                 #{item}
				</foreach>
	</update>
	
	<!-- 匹配书籍 -->
	<select id="matchingBook" parameterType="pd" resultType="pd">
		select
				a.ARTICLE_ID,	
				a.ARTICLE_CATEGORY_ID,	
				a.ARTICLE_CODE,	
				a.ARTICLE_NAME,	
				a.AUTHOR,	
				a.FEE_TYPE,	
				a.PAY_CONSUMES,	
				a.IS_HOT,	
				a.SUMMARY,	
				a.COUNT_LETTER,	
				a.COUNT_CHAPTERS,	
				a.STATE,	
				a.CREATE_TIME,
				a.COLLECTION,	
				a.READERS,	
				a.COUNT_CONSUMES,	
				a.CHANNEL_TYPE,
				a.SERIAL_STATE,
				a.BOOK_COVER,
				a.RECOMMEND
		from 
				TB_ARTICLE a
		where
				a.ARTICLE_NAME LIKE CONCAT(CONCAT('%', #{ARTICLE_NAME}),'%')
				<if test="ARTICLE_ID!=null and ARTICLE_ID!=''">
					and a.ARTICLE_ID = #{ARTICLE_ID}
				</if>
	</select>
	
	
	<!-- 添加章节时，书籍内章节数自增长1 -->
	<update id="updateChapternum" parameterType="pd">
		update  TB_ARTICLE
			set 
				COUNT_CHAPTERS = (
					SELECT
						COUNT(1) COUNT_CHAPTERS
					FROM
						tb_article_chapter
					where 
						ARTICLE_ID = #{ARTICLE_ID}
						and CHAPTER_STATE !=2
				)
			where 
				ARTICLE_ID = #{ARTICLE_ID}
	</update>
	
	<!-- 修改章价格时，改变书籍总价格 -->
	<update id="upSumConsumes" parameterType="pd">
		update  TB_ARTICLE
			set 
				COUNT_CONSUMES = COUNT_CONSUMES + #{COUNT_CONSUMES}
			where 
				ARTICLE_ID = #{ARTICLE_ID}
	</update>
	
	<!-- 添加章节时修改书籍总字数 -->
	<update id="chapterNumber" parameterType="pd">
		update  TB_ARTICLE
			set 
				COUNT_LETTER = COUNT_LETTER + #{NUMBER_CHAPTER}
			where 
				ARTICLE_ID = #{ARTICLE_ID}
	</update>
	<update id="upchapterNumber" parameterType="pd">
		update  TB_ARTICLE
			set 
				COUNT_LETTER = (
					SELECT
						IFNULL(SUM(NUMBER_CHAPTER),0) NUMBER_CHAPTER
					FROM
						tb_article_chapter
					where 
						ARTICLE_ID = #{ARTICLE_ID}
						and CHAPTER_STATE !=2
				)
			where 
				ARTICLE_ID = #{ARTICLE_ID}
	</update>
	<!-- 统计指定书籍的所有章节价格，更新书籍总价 -->
	<update id="updateSum" parameterType="pd">
		update  TB_ARTICLE
			set 
				COUNT_CONSUMES = (
					select
						sum(CONSUMES) CONSUMES
					from
						tb_article_chapter
					where 
						ARTICLE_ID = #{ARTICLE_ID}
						and CHAPTER_STATE !=2
				)
			where 
				ARTICLE_ID = #{ARTICLE_ID}
	</update>
	<!-- 渠道端 -->
	<!-- 列表 -->
	<select id="extensionBooklistPage" parameterType="page" resultType="pd">
		select
				a.ARTICLE_ID,	
				a.ARTICLE_CATEGORY_ID,	
				a.ARTICLE_CODE,	
				a.ARTICLE_NAME,	
				a.AUTHOR,	
				a.FEE_TYPE,	
				a.PAY_CONSUMES,	
				a.IS_HOT,	
				a.SUMMARY,	
				a.COUNT_LETTER,	
				a.COUNT_CHAPTERS,	
				a.STATE,	
				SUBSTRING(a.CREATE_TIME,1,10) CREATE_TIME,
				a.COLLECTION,	
				a.READERS,	
				a.COUNT_CONSUMES,	
				a.CHANNEL_TYPE,
				a.SERIAL_STATE,
				a.BOOK_COVER,
				ac.CATEGORY,
				a.RECOMMEND
		from 
				TB_ARTICLE a
				LEFT JOIN tb_article_category ac on a.ARTICLE_CATEGORY_ID = ac.ARTICLE_CATEGORY_ID
		where a.STATE = 1
				<if test="pd.CHANNEL_TYPE !=null and pd.CHANNEL_TYPE !=''">
					and a.CHANNEL_TYPE = #{pd.CHANNEL_TYPE}
				</if>
				<if test="pd.ARTICLE_CATEGORY_ID !=null and pd.ARTICLE_CATEGORY_ID !=''">
					and a.ARTICLE_CATEGORY_ID = #{pd.ARTICLE_CATEGORY_ID}
				</if>
				<if test="pd.names!=null and pd.names!=''">
				AND	(
					a.ARTICLE_NAME LIKE CONCAT(CONCAT('%', #{pd.names}),'%')
					or
					a.AUTHOR LIKE CONCAT(CONCAT('%', #{pd.names}),'%')
				)
				</if>
				order by CREATE_TIME desc
	</select>
	
	<!-- 通过书籍名称获取数据 -->
	<select id="findByName" parameterType="pd" resultType="pd">
		select 
			a.ARTICLE_ID,	
			a.ARTICLE_CATEGORY_ID,	
			a.ARTICLE_CODE,	
			a.ARTICLE_NAME,	
			a.AUTHOR,	
			a.FEE_TYPE,	
			a.PAY_CONSUMES,	
			a.IS_HOT,	
			a.SUMMARY,	
			a.COUNT_LETTER,	
			a.COUNT_CHAPTERS,	
			a.STATE,	
			a.CREATE_TIME,
			a.COLLECTION,	
			a.READERS,	
			a.COUNT_CONSUMES,	
			a.CHANNEL_TYPE,
			a.SERIAL_STATE,
			a.BOOK_COVER,
			a.RECOMMEND
		from 
			TB_ARTICLE a
		where 
			a.ARTICLE_NAME = #{ARTICLE_NAME}
	</select>
	
	<!-- 定时器自动更新
	 	  按榜单类型排序查询书籍
	 -->
	<select id="seachBoardSortArticle" parameterType="pd" resultType="pd">
		select 
			ARTICLE_ID,	
			ARTICLE_CATEGORY_ID,	
			ARTICLE_CODE,	
			ARTICLE_NAME,	
			AUTHOR,	
			FEE_TYPE,	
			PAY_CONSUMES,	
			IS_HOT,	
			SUMMARY,	
			COUNT_LETTER,	
			COUNT_CHAPTERS,	
			STATE,	
			CREATE_TIME,
			COLLECTION,	
			READERS,	
			COUNT_CONSUMES,	
			CHANNEL_TYPE,
			SERIAL_STATE,
			BOOK_COVER,
			RECOMMEND,
			FEEPOPLES
		from 
			TB_ARTICLE
		where  STATE = 1
			<if test="BOARD_ID!=null and BOARD_ID!=''">
				<if test="BOARD_ID==1">
					<if test="BOARD_TYPE==1">
						AND CHANNEL_TYPE = 0
					</if>
					<if test="BOARD_TYPE==2">
						AND CHANNEL_TYPE = 1
					</if>
					AND ARTICLE_ID NOT IN (
						SELECT
							ARTICLE_ID
						FROM
							tb_board_detail
						WHERE
							BOARD_ID = #{BOARD_ID}
							AND SORT_RULE != 0
							AND BOARD_TYPE = #{BOARD_TYPE}
					)
					ORDER BY FEEPOPLES DESC
				</if>
				<if test="BOARD_ID==2">
					<if test="BOARD_TYPE==1">
						AND CHANNEL_TYPE = 0
					</if>
					<if test="BOARD_TYPE==2">
						AND CHANNEL_TYPE = 1
					</if>
					AND ARTICLE_ID NOT IN (
						SELECT
							ARTICLE_ID
						FROM
							tb_board_detail
						WHERE
							BOARD_ID = #{BOARD_ID}
							AND SORT_RULE != 0
							AND BOARD_TYPE = #{BOARD_TYPE}
					)
					ORDER BY COLLECTION DESC
				</if>
				<if test="BOARD_ID==3">
					<if test="BOARD_TYPE==1">
						AND CHANNEL_TYPE = 0
					</if>
					<if test="BOARD_TYPE==2">
						AND CHANNEL_TYPE = 1
					</if>
					AND ARTICLE_ID NOT IN (
						SELECT
							ARTICLE_ID
						FROM
							tb_board_detail
						WHERE
							BOARD_ID = #{BOARD_ID}
							AND SORT_RULE != 0
							AND BOARD_TYPE = #{BOARD_TYPE}
					)
					ORDER BY DISPLAY_READERS DESC
				</if>
				<if test="BOARD_ID==4">
					<if test="BOARD_TYPE==1">
						AND CHANNEL_TYPE = 0
					</if>
					<if test="BOARD_TYPE==2">
						AND CHANNEL_TYPE = 1
					</if>
					AND ARTICLE_ID NOT IN (
						SELECT
							ARTICLE_ID
						FROM
							tb_board_detail
						WHERE
							BOARD_ID = #{BOARD_ID}
							AND SORT_RULE != 0
							AND BOARD_TYPE = #{BOARD_TYPE}
					)
					ORDER BY FEEPOPLES DESC
				</if>
				<if test="BOARD_ID==5">
					<if test="BOARD_TYPE==1">
						AND CHANNEL_TYPE = 0
					</if>
					<if test="BOARD_TYPE==2">
						AND CHANNEL_TYPE = 1
					</if>
					AND SERIAL_STATE = 1
					AND ARTICLE_ID NOT IN (
						SELECT
							ARTICLE_ID
						FROM
							tb_board_detail
						WHERE
							BOARD_ID = #{BOARD_ID}
							AND SORT_RULE != 0
							AND BOARD_TYPE = #{BOARD_TYPE}
					)
					ORDER BY DISPLAY_READERS DESC
				</if>
				<if test="BOARD_ID==6">
					<if test="BOARD_TYPE==1">
						AND CHANNEL_TYPE = 0
					</if>
					<if test="BOARD_TYPE==2">
						AND CHANNEL_TYPE = 1
					</if>
					AND SERIAL_STATE = 0
					AND ARTICLE_ID NOT IN (
						SELECT
							ARTICLE_ID
						FROM
							tb_board_detail
						WHERE
							BOARD_ID = #{BOARD_ID}
							AND SORT_RULE != 0
							AND BOARD_TYPE = #{BOARD_TYPE}
					)
					ORDER BY DISPLAY_READERS DESC
				</if>
				<if test="BOARD_ID==7">
					<if test="BOARD_TYPE==1">
						AND CHANNEL_TYPE = 0
					</if>
					<if test="BOARD_TYPE==2">
						AND CHANNEL_TYPE = 1
					</if>
					AND FEE_TYPE = 0
					AND ARTICLE_ID NOT IN (
						SELECT
							ARTICLE_ID
						FROM
							tb_board_detail
						WHERE
							BOARD_ID = #{BOARD_ID}
							AND SORT_RULE != 0
							AND BOARD_TYPE = #{BOARD_TYPE}
					)
					ORDER BY DISPLAY_READERS DESC
				</if>
				<if test="BOARD_ID==8">
					<if test="BOARD_TYPE==1">
						AND CHANNEL_TYPE = 0
					</if>
					<if test="BOARD_TYPE==2">
						AND CHANNEL_TYPE = 1
					</if>
					AND FEE_TYPE = 1
					AND ARTICLE_ID NOT IN (
						SELECT
							ARTICLE_ID
						FROM
							tb_board_detail
						WHERE
							BOARD_ID = #{BOARD_ID}
							AND SORT_RULE != 0
							AND BOARD_TYPE = #{BOARD_TYPE}
					)
					ORDER BY DISPLAY_READERS DESC
				</if>
			</if>
			limit 0,100
	</select>
	
	
	
	
</mapper>